(()=>{var e={459:(e,t,i)=>{var s=i(361).EventEmitter,r=e.exports=function(e){if(!function(e){var t=!!e._keypressDecoder;return t||(e.listeners("data").slice(0).forEach((function(t){"onData"==t.name&&/emitKey/.test(t.toString())&&e.removeListener("data",t)})),e.listeners("newListener").slice(0).forEach((function(t){"onNewListener"==t.name&&/keypress/.test(t.toString())&&e.removeListener("newListener",t)}))),t}(e)){var t=i(576).StringDecoder;e._keypressDecoder=new t("utf8"),n(e,"keypress")>0?e.on("data",s):e.on("newListener",r)}function s(t){if(n(e,"keypress")>0){var i=e._keypressDecoder.write(t);i&&c(e,i)}else e.removeListener("data",s),e.on("newListener",r)}function r(t){"keypress"==t&&(e.on("data",s),e.removeListener("newListener",r))}};r.enableMouse=function(e){e.write("[?1000h")},r.disableMouse=function(e){e.write("[?1000l")};var n=s.listenerCount;n||(n=function(e,t){return e.listeners(t).length});var o=/^(?:\x1b)([a-zA-Z0-9])$/,a=/^(?:\x1b+)(O|N|\[|\[\[)(?:(\d+)(?:;(\d+))?([~^$])|(?:1;)?(\d+)?([a-zA-Z]))/;function c(e,t){var i,s,r={name:void 0,ctrl:!1,meta:!1,shift:!1};if(Buffer.isBuffer(t)&&(t[0]>127&&void 0===t[1]?(t[0]-=128,t=""+t.toString(e.encoding||"utf-8")):t=t.toString(e.encoding||"utf-8")),r.sequence=t,"\r"===t)r.name="return";else if("\n"===t)r.name="enter";else if("\t"===t)r.name="tab";else if("\b"===t||""===t||""===t||"\b"===t)r.name="backspace",r.meta=""===t.charAt(0);else if(""===t||""===t)r.name="escape",r.meta=2===t.length;else if(" "===t||" "===t)r.name="space",r.meta=2===t.length;else if(t<="")r.name=String.fromCharCode(t.charCodeAt(0)+"a".charCodeAt(0)-1),r.ctrl=!0;else if(1===t.length&&t>="a"&&t<="z")r.name=t;else if(1===t.length&&t>="A"&&t<="Z")r.name=t.toLowerCase(),r.shift=!0;else if(s=o.exec(t))r.name=s[1].toLowerCase(),r.meta=!0,r.shift=/^[A-Z]$/.test(s[1]);else if(s=a.exec(t)){var n=(s[1]||"")+(s[2]||"")+(s[4]||"")+(s[6]||""),h=(s[3]||s[5]||1)-1;switch(r.ctrl=!!(4&h),r.meta=!!(10&h),r.shift=!!(1&h),r.code=n,n){case"OP":case"[11~":case"[[A":r.name="f1";break;case"OQ":case"[12~":case"[[B":r.name="f2";break;case"OR":case"[13~":case"[[C":r.name="f3";break;case"OS":case"[14~":case"[[D":r.name="f4";break;case"[[E":case"[15~":r.name="f5";break;case"[17~":r.name="f6";break;case"[18~":r.name="f7";break;case"[19~":r.name="f8";break;case"[20~":r.name="f9";break;case"[21~":r.name="f10";break;case"[23~":r.name="f11";break;case"[24~":r.name="f12";break;case"[A":case"OA":r.name="up";break;case"[B":case"OB":r.name="down";break;case"[C":case"OC":r.name="right";break;case"[D":case"OD":r.name="left";break;case"[E":case"OE":r.name="clear";break;case"[F":case"OF":case"[4~":case"[8~":r.name="end";break;case"[H":case"OH":case"[1~":case"[7~":r.name="home";break;case"[2~":r.name="insert";break;case"[3~":r.name="delete";break;case"[5~":case"[[5~":r.name="pageup";break;case"[6~":case"[[6~":r.name="pagedown";break;case"[a":r.name="up",r.shift=!0;break;case"[b":r.name="down",r.shift=!0;break;case"[c":r.name="right",r.shift=!0;break;case"[d":r.name="left",r.shift=!0;break;case"[e":r.name="clear",r.shift=!0;break;case"[2$":r.name="insert",r.shift=!0;break;case"[3$":r.name="delete",r.shift=!0;break;case"[5$":r.name="pageup",r.shift=!0;break;case"[6$":r.name="pagedown",r.shift=!0;break;case"[7$":r.name="home",r.shift=!0;break;case"[8$":r.name="end",r.shift=!0;break;case"Oa":r.name="up",r.ctrl=!0;break;case"Ob":r.name="down",r.ctrl=!0;break;case"Oc":r.name="right",r.ctrl=!0;break;case"Od":r.name="left",r.ctrl=!0;break;case"Oe":r.name="clear",r.ctrl=!0;break;case"[2^":r.name="insert",r.ctrl=!0;break;case"[3^":r.name="delete",r.ctrl=!0;break;case"[5^":r.name="pageup",r.ctrl=!0;break;case"[6^":r.name="pagedown",r.ctrl=!0;break;case"[7^":r.name="home",r.ctrl=!0;break;case"[8^":r.name="end",r.ctrl=!0;break;case"[Z":r.name="tab",r.shift=!0;break;default:r.name="undefined"}}else if(t.length>1&&""!==t[0])return void Array.prototype.forEach.call(t,(function(t){c(e,t)}));if("[M"==r.code){r.name="mouse";var l=(t=r.sequence).charCodeAt(3);r.x=t.charCodeAt(4)-32,r.y=t.charCodeAt(5)-32,r.scroll=0,r.ctrl=!!(16&l),r.meta=!!(8&l),r.shift=!!(4&l),r.release=3==(3&l),64&l&&(r.scroll=1&l?1:-1),r.release||r.scroll||(r.button=3&l)}void 0===r.name&&(r=void 0),1===t.length&&(i=t),r&&"mouse"==r.name?e.emit("mousepress",r):(r||i)&&e.emit("keypress",i,r)}},516:(e,t,i)=>{var s=i(147),r=i(17),n=i(37),o=require,a=process.config&&process.config.variables||{},c=!!process.env.PREBUILDS_ONLY,h=process.versions.modules,l=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":process.versions&&process.versions.nw?"node-webkit":"node",p=process.env.npm_config_arch||n.arch(),u=process.env.npm_config_platform||n.platform(),d=process.env.LIBC||(function(e){return"linux"===e&&s.existsSync("/etc/alpine-release")}(u)?"musl":"glibc"),f=process.env.ARM_VERSION||("arm64"===p?"8":a.arm_version)||"",b=(process.versions.uv||"").split(".")[0];function m(e){return o(m.path(e))}function g(e){try{return s.readdirSync(e)}catch(e){return[]}}function v(e,t){var i=g(e).filter(t);return i[0]&&r.join(e,i[0])}function E(e){return/\.node$/.test(e)}function k(e){var t=e.split("-");if(2===t.length){var i=t[0],s=t[1].split("+");if(i&&s.length&&s.every(Boolean))return{name:e,platform:i,architectures:s}}}function y(e,t){return function(i){return null!=i&&i.platform===e&&i.architectures.includes(t)}}function w(e,t){return e.architectures.length-t.architectures.length}function T(e){var t=e.split("."),i={file:e,specificity:0};if("node"===t.pop()){for(var s=0;s<t.length;s++){var r=t[s];if("node"===r||"electron"===r||"node-webkit"===r)i.runtime=r;else if("napi"===r)i.napi=!0;else if("abi"===r.slice(0,3))i.abi=r.slice(3);else if("uv"===r.slice(0,2))i.uv=r.slice(2);else if("armv"===r.slice(0,4))i.armv=r.slice(4);else{if("glibc"!==r&&"musl"!==r)continue;i.libc=r}i.specificity++}return i}}function O(e,t){return function(i){return!(null==i||i.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(i)||i.abi!==t&&!i.napi||i.uv&&i.uv!==b||i.armv&&i.armv!==f||i.libc&&i.libc!==d)}}function x(e){return function(t,i){return t.runtime!==i.runtime?t.runtime===e?-1:1:t.abi!==i.abi?t.abi?-1:1:t.specificity!==i.specificity?t.specificity>i.specificity?-1:1:0}}e.exports=m,m.path=function(e){e=r.resolve(e||".");try{var t=o(r.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!c){var i=v(r.join(e,"build/Release"),E);if(i)return i;var s=v(r.join(e,"build/Debug"),E);if(s)return s}var n=S(e);if(n)return n;var a=S(r.dirname(process.execPath));if(a)return a;var m=["platform="+u,"arch="+p,"runtime="+l,"abi="+h,"uv="+b,f?"armv="+f:"","libc="+d,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+m+"\n    loaded from: "+e+"\n");function S(e){var t=g(r.join(e,"prebuilds")).map(k).filter(y(u,p)).sort(w)[0];if(t){var i=r.join(e,"prebuilds",t.name),s=g(i).map(T).filter(O(l,h)).sort(x(l))[0];return s?r.join(i,s.file):void 0}}},m.parseTags=T,m.matchTags=O,m.compareTags=x,m.parseTuple=k,m.matchTuple=y,m.compareTuples=w},979:(e,t,i)=>{"use strict";t.yD=t.cK=t.Ib=t.tw=void 0;const s=i(361),r=i(17),n=i(516)((0,r.join)(__dirname,".."));var o,a,c;!function(e){e[e.Tap=0]="Tap",e[e.Down=1]="Down",e[e.Up=2]="Up"}(o||(o={})),function(e){e[e.EVENT_KEY_PRESSED=4]="EVENT_KEY_PRESSED",e[e.EVENT_KEY_RELEASED=5]="EVENT_KEY_RELEASED",e[e.EVENT_MOUSE_CLICKED=6]="EVENT_MOUSE_CLICKED",e[e.EVENT_MOUSE_PRESSED=7]="EVENT_MOUSE_PRESSED",e[e.EVENT_MOUSE_RELEASED=8]="EVENT_MOUSE_RELEASED",e[e.EVENT_MOUSE_MOVED=9]="EVENT_MOUSE_MOVED",e[e.EVENT_MOUSE_WHEEL=11]="EVENT_MOUSE_WHEEL"}(a=t.tw||(t.tw={})),(c=t.Ib||(t.Ib={}))[c.VERTICAL=3]="VERTICAL",c[c.HORIZONTAL=4]="HORIZONTAL",t.cK={Backspace:14,Tab:15,Enter:28,CapsLock:58,Escape:1,Space:57,PageUp:3657,PageDown:3665,End:3663,Home:3655,ArrowLeft:57419,ArrowUp:57416,ArrowRight:57421,ArrowDown:57424,Insert:3666,Delete:3667,0:11,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,A:30,B:48,C:46,D:32,E:18,F:33,G:34,H:35,I:23,J:36,K:37,L:38,M:50,N:49,O:24,P:25,Q:16,R:19,S:31,T:20,U:22,V:47,W:17,X:45,Y:21,Z:44,Numpad0:82,Numpad1:79,Numpad2:80,Numpad3:81,Numpad4:75,Numpad5:76,Numpad6:77,Numpad7:71,Numpad8:72,Numpad9:73,NumpadMultiply:55,NumpadAdd:78,NumpadSubtract:74,NumpadDecimal:83,NumpadDivide:3637,NumpadEnd:61007,NumpadArrowDown:61008,NumpadPageDown:61009,NumpadArrowLeft:61003,NumpadArrowRight:61005,NumpadHome:60999,NumpadArrowUp:61e3,NumpadPageUp:61001,NumpadInsert:61010,NumpadDelete:61011,F1:59,F2:60,F3:61,F4:62,F5:63,F6:64,F7:65,F8:66,F9:67,F10:68,F11:87,F12:88,F13:91,F14:92,F15:93,F16:99,F17:100,F18:101,F19:102,F20:103,F21:104,F22:105,F23:106,F24:107,Semicolon:39,Equal:13,Comma:51,Minus:12,Period:52,Slash:53,Backquote:41,BracketLeft:26,Backslash:43,BracketRight:27,Quote:40,Ctrl:29,CtrlRight:3613,Alt:56,AltRight:3640,Shift:42,ShiftRight:54,Meta:3675,MetaRight:3676,NumLock:69,ScrollLock:70,PrintScreen:3639};class h extends s.EventEmitter{handler(e){switch(this.emit("input",e),e.type){case a.EVENT_KEY_PRESSED:this.emit("keydown",e);break;case a.EVENT_KEY_RELEASED:this.emit("keyup",e);break;case a.EVENT_MOUSE_CLICKED:this.emit("click",e);break;case a.EVENT_MOUSE_MOVED:this.emit("mousemove",e);break;case a.EVENT_MOUSE_PRESSED:this.emit("mousedown",e);break;case a.EVENT_MOUSE_RELEASED:this.emit("mouseup",e);break;case a.EVENT_MOUSE_WHEEL:this.emit("wheel",e)}}start(){n.start(this.handler.bind(this))}stop(){n.stop()}keyTap(e,t=[]){if(!t.length)return void n.keyTap(e,o.Tap);for(const e of t)n.keyTap(e,o.Down);n.keyTap(e,o.Tap);let i=t.length;for(;i--;)n.keyTap(t[i],o.Up)}keyToggle(e,t){n.keyTap(e,"down"===t?o.Down:o.Up)}}t.yD=new h},361:e=>{"use strict";e.exports=require("events")},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},576:e=>{"use strict";e.exports=require("string_decoder")}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,i),n.exports}(()=>{"use strict";const e=(e=0)=>t=>`[${t+e}m`,t=(e=0)=>t=>`[${38+e};5;${t}m`,s=(e=0)=>(t,i,s)=>`[${38+e};2;${t};${i};${s}m`,r={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(r.modifier),Object.keys(r.color),Object.keys(r.bgColor);const n=function(){const i=new Map;for(const[e,t]of Object.entries(r)){for(const[e,s]of Object.entries(t))r[e]={open:`[${s[0]}m`,close:`[${s[1]}m`},t[e]=r[e],i.set(s[0],s[1]);Object.defineProperty(r,e,{value:t,enumerable:!1})}return Object.defineProperty(r,"codes",{value:i,enumerable:!1}),r.color.close="[39m",r.bgColor.close="[49m",r.color.ansi=e(),r.color.ansi256=t(),r.color.ansi16m=s(),r.bgColor.ansi=e(10),r.bgColor.ansi256=t(10),r.bgColor.ansi16m=s(10),Object.defineProperties(r,{rgbToAnsi256:{value:(e,t,i)=>e===t&&t===i?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(i/255*5),enumerable:!1},hexToRgb:{value(e){const t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[i]=t;3===i.length&&(i=[...i].map((e=>e+e)).join(""));const s=Number.parseInt(i,16);return[s>>16&255,s>>8&255,255&s]},enumerable:!1},hexToAnsi256:{value:e=>r.rgbToAnsi256(...r.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return e-8+90;let t,i,s;if(e>=232)t=(10*(e-232)+8)/255,i=t,s=t;else{const r=(e-=16)%36;t=Math.floor(e/36)/5,i=Math.floor(r/6)/5,s=r%6/5}const r=2*Math.max(t,i,s);if(0===r)return 30;let n=30+(Math.round(s)<<2|Math.round(i)<<1|Math.round(t));return 2===r&&(n+=60),n},enumerable:!1},rgbToAnsi:{value:(e,t,i)=>r.ansi256ToAnsi(r.rgbToAnsi256(e,t,i)),enumerable:!1},hexToAnsi:{value:e=>r.ansi256ToAnsi(r.hexToAnsi256(e)),enumerable:!1}}),r}(),o=require("node:process"),a=require("node:os"),c=require("node:tty");function h(e,t=o.argv){const i=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(i+e),r=t.indexOf("--");return-1!==s&&(-1===r||s<r)}const{env:l}=o;let p;function u(e,t={}){return 0!==(i=function(e,{streamIsTTY:t,sniffFlags:i=!0}={}){const s=function(){if("FORCE_COLOR"in l)return"true"===l.FORCE_COLOR?1:"false"===l.FORCE_COLOR?0:0===l.FORCE_COLOR.length?1:Math.min(Number.parseInt(l.FORCE_COLOR,10),3)}();void 0!==s&&(p=s);const r=i?p:s;if(0===r)return 0;if(i){if(h("color=16m")||h("color=full")||h("color=truecolor"))return 3;if(h("color=256"))return 2}if(e&&!t&&void 0===r)return 0;const n=r||0;if("dumb"===l.TERM)return n;if("win32"===o.platform){const e=a.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in l)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in l))||"codeship"===l.CI_NAME?1:n;if("TEAMCITY_VERSION"in l)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(l.TEAMCITY_VERSION)?1:0;if("TF_BUILD"in l&&"AGENT_NAME"in l)return 1;if("truecolor"===l.COLORTERM)return 3;if("TERM_PROGRAM"in l){const e=Number.parseInt((l.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(l.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(l.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(l.TERM)||"COLORTERM"in l?1:n}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:i,hasBasic:!0,has256:i>=2,has16m:i>=3};var i}h("no-color")||h("no-colors")||h("color=false")||h("color=never")?p=0:(h("color")||h("colors")||h("color=true")||h("color=always"))&&(p=1);const d={stdout:u({isTTY:c.isatty(1)}),stderr:u({isTTY:c.isatty(2)})};function f(e,t,i){let s=e.indexOf(t);if(-1===s)return e;const r=t.length;let n=0,o="";do{o+=e.slice(n,s)+t+i,n=s+r,s=e.indexOf(t,n)}while(-1!==s);return o+=e.slice(n),o}const{stdout:b,stderr:m}=d,g=Symbol("GENERATOR"),v=Symbol("STYLER"),E=Symbol("IS_EMPTY"),k=["ansi","ansi","ansi256","ansi16m"],y=Object.create(null);function w(e){return(e=>{const t=(...e)=>e.join(" ");return((e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const i=b?b.level:0;e.level=void 0===t.level?i:t.level})(t,e),Object.setPrototypeOf(t,w.prototype),t})(e)}Object.setPrototypeOf(w.prototype,Function.prototype);for(const[e,t]of Object.entries(n))y[e]={get(){const i=R(this,S(t.open,t.close,this[v]),this[E]);return Object.defineProperty(this,e,{value:i}),i}};y.visible={get(){const e=R(this,this[v],!0);return Object.defineProperty(this,"visible",{value:e}),e}};const T=(e,t,i,...s)=>"rgb"===e?"ansi16m"===t?n[i].ansi16m(...s):"ansi256"===t?n[i].ansi256(n.rgbToAnsi256(...s)):n[i].ansi(n.rgbToAnsi(...s)):"hex"===e?T("rgb",t,i,...n.hexToRgb(...s)):n[i][e](...s),O=["rgb","hex","ansi256"];for(const e of O)y[e]={get(){const{level:t}=this;return function(...i){const s=S(T(e,k[t],"color",...i),n.color.close,this[v]);return R(this,s,this[E])}}},y["bg"+e[0].toUpperCase()+e.slice(1)]={get(){const{level:t}=this;return function(...i){const s=S(T(e,k[t],"bgColor",...i),n.bgColor.close,this[v]);return R(this,s,this[E])}}};const x=Object.defineProperties((()=>{}),{...y,level:{enumerable:!0,get(){return this[g].level},set(e){this[g].level=e}}}),S=(e,t,i)=>{let s,r;return void 0===i?(s=e,r=t):(s=i.openAll+e,r=t+i.closeAll),{open:e,close:t,openAll:s,closeAll:r,parent:i}},R=(e,t,i)=>{const s=(...e)=>A(s,1===e.length?""+e[0]:e.join(" "));return Object.setPrototypeOf(s,x),s[g]=e,s[v]=t,s[E]=i,s},A=(e,t)=>{if(e.level<=0||!t)return e[E]?"":t;let i=e[v];if(void 0===i)return t;const{openAll:s,closeAll:r}=i;if(t.includes(""))for(;void 0!==i;)t=f(t,i.close,i.open),i=i.parent;const n=t.indexOf("\n");return-1!==n&&(t=function(e,t,i,s){let r=0,n="";do{const o="\r"===e[s-1];n+=e.slice(r,o?s-1:s)+t+(o?"\r\n":"\n")+i,r=s+1,s=e.indexOf("\n",r)}while(-1!==s);return n+=e.slice(r),n}(t,r,s,n)),s+t+r};Object.defineProperties(w.prototype,y);const N=w(),_=(w({level:m?m.level:0}),N),D=[400,800,1200,1600],C=[0,100,300,500,800],L=[100,200],M=[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]],B=[{name:"I",x:2,y:22,tetro:[[0,0,0,0,0],[0,0,0,0,0],[0,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0]],kick:[[[0,0],[-1,0],[2,0],[-1,0],[2,0]],[[-1,0],[0,0],[0,0],[0,1],[0,-2]],[[-1,1],[1,1],[-2,1],[1,0],[-2,0]],[[0,1],[0,1],[0,1],[0,-1],[0,2]]]},{name:"O",x:3,y:21,tetro:[[0,2,2],[0,2,2],[0,0,0]],kick:[[[0,0]],[[0,-1]],[[-1,-1]],[[-1,0]]]},{name:"T",x:3,y:21,tetro:[[0,3,0],[3,3,3],[0,0,0]],kick:M},{name:"S",x:3,y:21,tetro:[[0,4,4],[4,4,0],[0,0,0]],kick:M},{name:"Z",x:3,y:21,tetro:[[5,5,0],[0,5,5],[0,0,0]],kick:M},{name:"J",x:3,y:21,tetro:[[6,0,0],[6,6,6],[0,0,0]],kick:M},{name:"L",x:3,y:21,tetro:[[0,0,7],[7,7,7],[0,0,0]],kick:M}];class I{constructor({x:e,y:t,tetro:i,kick:s,name:r},n){this.miniTSpin=!1,this.tSpin=!1,this.name=r,this.board=n,this.pos=0,this.x=e,this.y=t,this.origX=e,this.origY=t,this.tetro=i,this.kick=s,this.lock=n.lockDelay,this.moves=15,this.moved=!1,this.lowestLine=t}rotate(e){const t=[[[0,0],[2,0],[0,2],[2,2]],[[0,2],[2,2],[0,0],[2,0]],[[2,2],[0,2],[2,0],[0,0]],[[0,2],[0,0],[2,2],[2,0]]];this.moved=!0,this.moves--;var i=[];if(e)for(var s=0;s<this.tetro.length;s++){i[s]=[];for(var r=0;r<this.tetro[s].length;r++)i[s][r]=this.tetro[r][this.tetro.length-s-1]}else for(s=0;s<this.tetro.length;s++)for(i[s]=[],r=0;r<this.tetro[s].length;r++)i[s][r]=this.tetro[this.tetro.length-r-1][s];for(var n=this.pos,o=(this.pos+(e?3:1))%4,a=0;a<this.kick[0].length;a++)if(this.board.moveValid(this.x+this.kick[n][a][0]-this.kick[o][a][0],this.y+this.kick[n][a][1]-this.kick[o][a][1],i))return this.x+=this.kick[n][a][0]-this.kick[o][a][0],this.y+=this.kick[n][a][1]-this.kick[o][a][1],this.tetro=i,this.pos=o,"T"==this.name&&(this.tSpin=0!==this.board.board[t[this.pos][0][1]+(this.board.board.length-this.y-1)][t[this.pos][0][0]+this.x]&&0!==this.board.board[t[this.pos][1][1]+(this.board.board.length-this.y-1)][t[this.pos][1][0]+this.x]&&(0!==this.board.board[t[this.pos][2][1]+(this.board.board.length-this.y-1)][t[this.pos][2][0]+this.x]||0!==this.board.board[t[this.pos][3][1]+(this.board.board.length-this.y-1)][t[this.pos][3][0]+this.x]),this.miniTSpin=0!==this.board.board[t[this.pos][3][1]+(this.board.board.length-this.y-1)][t[this.pos][3][0]+this.x]&&0!==this.board.board[t[this.pos][2][1]+(this.board.board.length-this.y-1)][t[this.pos][2][0]+this.x]&&(0!==this.board.board[t[this.pos][1][1]+(this.board.board.length-this.y-1)][t[this.pos][1][0]+this.x]||0!==this.board.board[t[this.pos][0][1]+(this.board.board.length-this.y-1)][t[this.pos][0][0]+this.x])),!0;return!1}getDrop(e=0){for(var t=1;t<=e&&this.board.moveValid(this.x,this.y-t,this.tetro);t++);return t-1}stepDown(e=1){return this.y-=this.getDrop(e)}hardDrop(){this.y-=this.getDrop(20),this.board.addPiece(this)}shift(e=0){return this.moved=!0,this.moves--,!!this.board.moveValid(this.x+e,this.y,this.tetro)&&(this.x+=e,!0)}}class P{seed=0;constructor(e){this.seed=e}Next(){this.seed++;let e=15485863*this.seed;return e*e*e%2038074743/2038074743}}class F{constructor(e,t,{seed:i=Date.now(),lock:s=500}={}){this.lockDelay=s,this.lastStates=[],this.b2b=!1,this.score=0,this.elapsed=0,this.dropRate=1,this.secsRemaining=1,this.board=Array(2*e).fill().map((()=>Array(t).fill(0))),this.piece=null,this.length=e,this.width=t,this.rng=new P(i),this.hold=null,this.level=1,this.linesCleared=0;var r=B.slice();r.sort((()=>.5-this.rng.Next())),this.bag=r,this.next=[];for(var n=0;n<5;n++)this.next.push(this.bag.shift())}newBag(){var e=B.slice();e.sort((()=>.5-this.rng.Next())),this.bag=e}update(e,t){this.elapsed+=e,this.secsRemaining-=t?20*e:e;var i=0;if(this.secsRemaining<=0)for(;this.secsRemaining<=0;this.secsRemaining+=this.dropRate)i++;if(this.piece.stepDown(i),this.piece.y<this.piece.lowestLine&&(this.piece.moves=15),this.piece.lowestLine=this.piece.y<this.piece.lowestLine?this.piece.y:this.piece.lowestLine,!this.moveValid(this.piece.x,this.piece.y-1,this.piece.tetro)){if(this.piece.lock-=e,this.piece.moves<0)return this.addPiece(this.piece);if(this.piece.moved&&(this.piece.moved=!1,this.piece.lock=this.lockDelay),this.piece.lock<=0)return this.addPiece(this.piece)}return this.lastStates.push({lines:0,flags:0,scoreIncrease:0}),{lines:0,flags:0,scoreIncrease:0}}nextPiece(){for(var e=[],t=0;t<5;t++)e.push(this.next[t].tetro[1][1]);for(e=[],t=0;t<this.bag.length;t++)e.push(this.bag[t].tetro[1][1]);var i=this.next.shift();this.piece=new I(i,this),0==this.bag.length&&this.newBag(),this.next.push(this.bag.shift())}hardDrop(){return this.piece.hardDrop()}rotCCW(){return this.piece.rotate(!0)}rotCC(){return this.piece.rotate()}holdPiece(){if(null==this.hold){for(this.piece.x=this.piece.origX,this.piece.y=this.piece.origY;0!==this.piece.pos;)this.piece.rotate();this.hold=this.piece,this.nextPiece()}else{for(this.piece.x=this.piece.origX,this.piece.y=this.piece.origY;0!==this.piece.pos;)this.piece.rotate();var e=new I(this.piece,this),t=new I(this.hold,this);this.piece=t,this.hold=e}}setLevel(e=1){return this.level=e,this.secsRemaining=1e3*(.8-.007*(e-1))**(e-1),this.dropRate=1e3*(.8-.007*(e-1))**(e-1)}addPiece(e){for(var t=0;t<e.tetro.length;t++)for(var i=0;i<e.tetro[t].length;i++)0!==e.tetro[t][i]&&(this.board[t+(this.board.length-e.y-1)][i+e.x]=e.tetro[t][i]);var s=0;for(t=0;t<this.board.length;t++)this.board[t].every((e=>0!==e))&&(this.board.splice(t,1),this.board.unshift(Array(this.width).fill(0)),s++,this.linesCleared++,Math.floor(this.linesCleared/10)>this.level-1&&this.setLevel(++this.level));var r=0;this.nextPiece(),e.tSpin?r+=D[s]*(this.b2b&&0!==s?1.5:1)*this.level:e.miniTSpin?r+=L[s]*(this.b2b&&0!==s?1.5:1)*this.level:0!==s&&(r+=C[s]*(this.b2b&&4==s?1.5:1)*this.level),this.score+=r;var n=this.b2b;return(e.tSpin||e.miniTSpin||4==s)&&0!==s?this.b2b=!0:0!==s&&(this.b2b=n=!1),this.lastStates.push({lines:s,flags:e.tSpin<<0|e.miniTSpin<<1|n<<2,scoreIncrease:r}),{lines:s,flags:e.tSpin<<0|e.miniTSpin<<1|n<<2,scoreIncrease:r}}toString(){for(var e="",t=0;t<this.board.length;t++){for(var i=0;i<this.board[t].length;i++)this.piece&&this.piece.x<=i&&i<this.piece.x+this.piece.tetro.length&&this.board.length-this.piece.y-1<=t&&t<this.board.length-this.piece.y-1+this.piece.tetro.length?e+=this.piece.tetro[t-(this.board.length-this.piece.y-1)][i-this.piece.x]:e+=this.board[t][i];e+=(t==this.length-1?"\n"+"-".repeat(this.width):"")+"\n"}return e}moveValid(e,t,i){for(var s=this.board.length-t-1;s<i.length+this.board.length-t-1;s++)for(var r=e;r<i[0].length+e;r++){if(0!==i[s-this.board.length+t+1][r-e]&&(s>=this.board.length||r>=this.width))return!1;if(!(s>=this.board.length||r>=this.width)&&0!==this.board[s][r]&&0!==i[s-this.board.length+t+1][r-e])return!1}return!0}}var V=i(459),U=i(979),j=!1,K=[],$=0;const Y={lock:500};var q=[_.inverse.white,_.inverse.cyan,_.inverse.yellow,_.inverse.magenta,_.inverse.green,_.inverse.red,_.inverse.blue,_.hex("#FFA500").inverse,_.inverse.grey],G=[_.inverse.whiteBright,_.inverse.cyanBright,_.inverse.yellowBright,_.inverse.magentaBright,_.inverse.greenBright,_.inverse.redBright,_.inverse.blueBright,_.hex("#FFD380").inverse,_.inverse.grey];F.prototype.toString=function(){for(var e="",t=0;t<this.board.length;t++)if(!(t<H.length-1)){for(var i=0;i<this.board[t].length;i++)if(this.piece&&this.piece.x<=i&&i<this.piece.x+this.piece.tetro.length&&this.board.length-this.piece.y-1<=t&&t<this.board.length-this.piece.y-1+this.piece.tetro.length&&0!==this.piece.tetro[t-(this.board.length-this.piece.y-1)][i-this.piece.x]){if(Math.floor(this.elapsed/100)%2==0&&(this.piece.tSpin||this.piece.miniTSpin)){e+="  ";continue}e+=q[this.piece.tetro[t-(this.board.length-this.piece.y-1)][i-this.piece.x]]("  ")}else this.piece&&this.piece.x<=i&&i<this.piece.x+this.piece.tetro.length&&this.board.length-this.piece.y+this.piece.getDrop(20)-1<=t&&t<this.board.length-this.piece.y+this.piece.getDrop(20)-1+this.piece.tetro.length&&0!==this.piece.tetro[t-(this.board.length-this.piece.y+this.piece.getDrop(20)-1)][i-this.piece.x]&&0!==this.piece.getDrop(20)?e+=G[this.piece.tetro[t-(this.board.length-this.piece.y+this.piece.getDrop(20)-1)][i-this.piece.x]]("  "):e+=q[this.board[t][i]]("  ");e+=(t==this.length-1?"\n"+"--".repeat(this.width):"")+"\n"}return e};var H=new F(20,10,Y);H.nextPiece(),H.setLevel(10),V(process.stdin),process.stdin.setRawMode(!0),U.yD.on("keydown",(e=>{if(e){switch(e.keycode){case U.cK.A:case U.cK.ArrowLeft:H.piece.shift(-1);break;case U.cK.D:case U.cK.ArrowRight:H.piece.shift(1);break;case U.cK.S:case U.cK.ArrowDown:j=!0;break;case U.cK.Space:H.hardDrop();break;case U.cK.Z:H.rotCCW();break;case U.cK.W:case U.cK.ArrowUp:case U.cK.X:H.rotCC();break;case U.cK.C:H.holdPiece();break;case U.cK.R:(H=new F(20,10,Y)).nextPiece(),H.setLevel(10)}e.keycode==U.cK.C&&e.ctrlKey&&process.exit(1)}})),U.yD.on("keyup",(e=>{if(e)switch(e.keycode){case U.cK.S:case U.cK.ArrowDown:j=!1}})),U.yD.start(),setInterval((()=>{$+=10,K=K.filter((e=>e[1]+1e3>$)),console.clear(),H.update(10,j);for(var e=0;e<H.lastStates.length;e++){var t=H.lastStates.shift(),i="";1&t.flags?i+="T-spin ":2&t.flags&&(i+="Mini T-Spin "),""!=(i+=["","Single ","Double ","Triple ","Tetris "][t.lines]+(0!==t.scoreIncrease?`(+${4&t.flags?t.scoreIncrease*(2/3):t.scoreIncrease})`:""))&&K.push([i,$]),4&t.flags&&0!==t.lines&&K.push([`Back to Back (+${t.scoreIncrease*(1/3)})`,$])}let s=[];for(let e=0;e<H.next.length;e++)s.push(H.next[e].name);console.log(H.toString()+"Next: "+s.join(",")+"\nHold: "+(null==H.hold?"N/A":H.hold.name)+"\nLevel: "+H.level+` (${H.dropRate} ms/cell)\nScore: `+H.score.toString()+"\n "+" *".repeat(H.piece.moves>0?H.piece.moves:0)+`\n${function(e,t,i){for(var s="[",r=0;r<31;r++)Math.floor(31*t/i)>=r?s+="=":s+=" ";return s+"]"}(0,H.piece.lock,H.lockDelay)} ${H.lockDelay}ms`+`\n${K.reduce(((e,t)=>e+"\n"+t[0]),"")}`)}),10)})()})();